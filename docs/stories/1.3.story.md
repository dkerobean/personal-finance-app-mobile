# Status

Draft

---

# Story

**As a** user,
**I want** to create, view, update, and delete my own spending and income categories,
**so that** I can organize my transactions in a way that makes sense to me.

---

# Acceptance Criteria

1. A "Categories" management screen exists within the app's settings.
2. Users can add a new category with a name and select an icon/color.
3. A default set of common categories (e.g., Food, Transport, Salary) is created for every new user.
4. The user can view a list of all their categories.
5. The user can edit the name, icon, or color of an existing category.
6. The user can delete a category they created.

Source: `docs/prd/epic-1-foundation-manual-finance-tracking-v2.md#story-13-custom-category-management-crud`

---

# Tasks / Subtasks

- [ ] Categories UI and Navigation (AC: 1)
  - [ ] Add a Settings area entry: "Categories" → `app/(app)/settings/categories/index.tsx` [Source: `docs/architecture.md#Routing Architecture`]
  - [ ] Use Gluestack UI for list items and forms [Source: `docs/architecture.md#Tech Stack`]

- [ ] Create Category (AC: 2)
  - [ ] Screen/modal `.../categories/create.tsx` with inputs: `name`, icon picker; color picker (UI) [Source: `docs/architecture.md#Frontend Architecture`]
  - [ ] POST to backend Categories API to create new category [Source: `docs/architecture.md#API Specification` → `/categories`]
  - [ ] On success, refresh categories list and show success toast [Source: `docs/architecture.md#Frontend Error Handling`]

- [ ] Default Categories for New Users (AC: 3)
  - [ ] On first categories load, if empty, call backend endpoint/logic to seed defaults for user [Source: `docs/architecture.md#Components` → Backend Components / Repository Pattern`]
  - [ ] Ensure idempotency (no duplicates on subsequent loads)

- [ ] List, Edit, Delete (AC: 4, 5, 6)
  - [ ] Fetch and display user's categories from API [Source: `docs/architecture.md#API Specification` → `/categories`]
  - [ ] Edit flow: open `.../categories/edit/[id].tsx`, PATCH category name/icon (and color UI) [Source: `docs/architecture.md#Components` & `#API Specification`]
  - [ ] Delete flow: confirmation dialog; DELETE the category; refresh list [Source: `docs/architecture.md#API Specification`]

- [ ] State Management and Services
  - [ ] `src/services/api/categories.ts` with typed functions for list/create/update/delete [Source: `docs/architecture.md#Frontend Services Layer`]
  - [ ] `src/stores/categoryStore.ts` (Zustand) to hold categories and loading/error state [Source: `docs/architecture.md#State Management Architecture`]

- [ ] Error Handling & UX
  - [ ] Normalize API errors to user-friendly messages [Source: `docs/architecture.md#Error Handling Strategy`]
  - [ ] Show loading states and empty states

- [ ] Testing
  - [ ] Unit/component tests for create/edit/delete forms and list rendering (Jest + RNTL) [Source: `docs/architecture.md#Frontend Testing`]
  - [ ] Integration tests mocking Categories API for success and error paths [Source: `docs/architecture.md#Testing Strategy`]

---

# Dev Notes

## Data Models
- Category: `id`, `user_id | null`, `name`, `icon_name` [Source: `docs/architecture.md#Data Models` → Categories]
- Color is mentioned in PRD but there is no color field defined in architecture data model. No specific persistence guidance found in architecture docs.

## API Specifications
- Use REST endpoints for Categories per architecture (GET/POST and PATCH/DELETE by id) [Source: `docs/architecture.md#API Specification` → `/categories`]

## Component Specifications
- Settings → Categories list, create/edit modals, delete confirmation [Source: `docs/architecture.md#Frontend Architecture`]

## File Locations
- `app/(app)/settings/categories/index.tsx`, `.../create.tsx`, `.../edit/[id].tsx`
- `src/services/api/categories.ts`, `src/stores/categoryStore.ts` [Source: `docs/architecture.md#Frontend Services Layer`, `#State Management Architecture`]

## Testing Requirements
- Co-located tests with components; integration tests mock API layer [Source: `docs/architecture.md#Frontend Testing`, `#Testing Strategy`]

## Technical Constraints
- TypeScript; Gluestack UI; align with Unified Project Structure [Source: `docs/architecture.md#Tech Stack`, `#Unified Project Structure`]

---

# Change Log

| Date       | Version | Description                               | Author |
| ---------- | ------- | ----------------------------------------- | ------ |
| 2025-08-12 | 1.0     | Initial story draft created (SM)          | Bob    |

---

## Dev Agent Record

### Agent Model Used
{{agent_model_name_version}}

### Debug Log References

### Completion Notes List

### File List

---

## QA Results

Pending QA review.



